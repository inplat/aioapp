version: '2'
services:
  tracer:
    image: jaegertracing/all-in-one
    ports:
      - "10100:9411"
      - "10101:16686"
    environment:
      - COLLECTOR_ZIPKIN_HTTP_PORT=9411
    logging:
      driver: none
  rabbit:
    image: rabbitmq
    ports:
      - "10102:5672"
  postgres:
    image: postgres
    ports:
      - "10103:5432"
  redis:
    image: redis
    ports:
      - "10104:6379"
  influxdb:
    # http://influxdb:8086/
    image: influxdb:latest
    container_name: influxdb
    environment:
      - INFLUXDB_DATA_ENGINE=tsm1
      - INFLUXDB_REPORTING_DISABLED=false
    volumes:
      - /tmp/influx:/var/lib/influxdb
  telegraf:
    image: telegraf:latest
    container_name: telegraf
    links:
      - influxdb
    ports:
      - "10105:8094/udp"
    volumes:
      - ./docker/telegraf.conf:/etc/telegraf/telegraf.conf:ro
  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    ports:
      - "10106:3000"
    environment:
      - GF_INSTALL_PLUGINS=grafana-clock-panel,briangann-gauge-panel,natel-plotly-panel,grafana-simple-json-datasource
    links:
      - influxdb
